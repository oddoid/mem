#!/usr/bin/env sh
''''exec fontforge -script "$0" "$@" #'''

import fontforge
import sys

sfd = sys.argv[1]
svgs = sys.argv[2:]

# accepts a filename in the following format _xx_yy.svg where xx is row [0, 15]
# and yy is column [0, 15]
def filenameToCharCode(filename):
  (hexs, units) = filename.replace('.svg', '').split('_')[1:]
  return int(hexs) * 16 + int(units)

charToFilename = {}
for svg in svgs:
  charToFilename[filenameToCharCode(svg)] = svg

font = fontforge.font()

# todo: move this font metadata to a more appropriate place
font.familyname = 'mem'
font.fontname = 'mem' # todo: mem-mono
font.fullname = 'mem' # todo: mem mono

for char, filename in charToFilename.iteritems():
  glyph = font.createMappedChar(char)
  glyph.importOutlines(filename)

# todo: rename this script or move this to a new script
icon = font.createChar(32, 'space')
icon.width = 1000

font.save(sfd)